<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FAHP Analytical Hierarchy</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="header-box">
        <h1>FUZZY Analytical Hierarchy</h1>
    </div>

    <div class="main-container">
        <div class="content-body">
            <div class="sidebar">
                <h2>Steps of FAHP</h2>
                <ul id="fahp-steps">
                    <li id="step1">
                        <div class="step-container">
                            <span class="circle" id="circle1">✔</span>
                            <span>Step 1: Set Goal</span>
                        </div>
                        <div class="progress-bar" id="progress-bar1"></div>
                    </li>
                    <li id="step2">
                        <div class="step-container">
                            <span class="circle" id="circle2">✔</span>
                            <span>Step 2: Pairwise Comparison</span>
                        </div>
                        <div class="progress-bar" id="progress-bar2"></div>
                    </li>
                    <li id="step3">
                        <div class="step-container">
                            <span class="circle" id="circle3">✔</span>
                            <span>Step 3: Fuzzy Synthetic Extent</span>
                        </div>
                        <div class="progress-bar" id="progress-bar3"></div>
                    </li>
                    <li id="step4">
                        <div class="step-container">
                            <span class="circle" id="circle4">✔</span>
                            <span>Step 4: Priority Weights Calculation</span>
                        </div>
                        <div class="progress-bar" id="progress-bar4"></div>
                    </li>
                </ul>
            </div>

            <div class="content">
                <div class="upload-section">
                    <label for="file-input">Choose the dataset:</label>
                    <input type="file" name="file" class="upload-input" id="file-input" required />
                    <button type="button" class="upload-btn" id="upload-btn">Upload</button>
                </div>

                <div class="criteria-section">
                    <label for="custom_criteria">Or add your custom criteria:</label>
                    <input type="text" id="custom_criteria" placeholder="Enter custom criteria" />
                    <button type="button" onclick="addCustomCriteria()">Add Criteria</button>

                    <label for="criteria">Select the criteria:</label>
                    <select id="criteria" name="criteria">
                        <option value="throughput">Throughput</option>
                        <option value="latency">Latency</option>
                        <option value="response_time">Response Time</option>
                        <option value="network_load">Network Load</option>
                    </select>
                    <button type="button" class="select-btn" id="criteria-btn" disabled>Select</button>
                </div>

                <div class="weights-section">
                    <label for="weights">Select linguistic weights:</label>
                    <select id="weights" name="weights">
                        <option value="equally_important">Equally Important</option>
                        <option value="moderately_important">Moderately Important</option>
                        <option value="strongly_important">Strongly Important</option>
                    </select>
                    <button type="button" class="select-btn" id="weights-btn" disabled>Select</button>
                </div>

                <div class="run-section">
                    <button id="run-btn" class="run-btn" disabled>Run</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Handle file upload and progress to next step
        document.getElementById("upload-btn").addEventListener("click", function () {
            var fileInput = document.getElementById("file-input").files[0];
            if (fileInput) {
                var formData = new FormData();
                formData.append("file", fileInput);

                var xhr = new XMLHttpRequest();
                xhr.open("POST", "/", true);
                xhr.onload = function () {
                    if (xhr.status === 200) {
                        // On success, change button state and move to next step
                        document.getElementById("upload-btn").innerText = "Uploaded";
                        document.getElementById("upload-btn").style.backgroundColor = "#3498db";
                        document.getElementById("upload-btn").disabled = true;

                        // Progress to Step 2
                        updateStepProgress(1);
                        document.getElementById("criteria-btn").disabled = false;  // Enable next button
                    } else {
                        alert("Error uploading file.");
                    }
                };
                xhr.send(formData);
            } else {
                alert("Please choose a file to upload.");
            }
        });

        // Update progress and enable next steps
        function updateStepProgress(step) {
            document.getElementById(`progress-bar${step}`).style.width = "100%";
            document.getElementById(`circle${step}`).classList.add("completed");
        }

        // Handle criteria selection
        document.getElementById("criteria-btn").addEventListener("click", function () {
            updateStepProgress(2);  // Move to Step 3
            document.getElementById("weights-btn").disabled = false;  // Enable weights selection
        });

        // Handle weights selection
        document.getElementById("weights-btn").addEventListener("click", function () {
            updateStepProgress(3);  // Move to Step 4
            document.getElementById("run-btn").disabled = false;  // Enable Run button
        });

        // Handle run FAHP process
        document.getElementById("run-btn").addEventListener("click", function () {
            updateStepProgress(4);  // Final step completion
            alert("FAHP process completed!");  // Add FAHP process call here
        });

        // Handle adding custom criteria
        function addCustomCriteria() {
            var customCriteria = document.getElementById("custom_criteria").value.trim();
            if (customCriteria) {
                var option = document.createElement("option");
                option.text = customCriteria;
                option.value = customCriteria.toLowerCase().replace(/\s+/g, '_');
                document.getElementById("criteria").appendChild(option);
            }
        }
    </script>
</body>
</html>
